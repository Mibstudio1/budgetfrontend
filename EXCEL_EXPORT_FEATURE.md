# ฟีเจอร์การส่งออก Excel

## ภาพรวม
ระบบได้เพิ่มฟีเจอร์การส่งออกข้อมูลเป็นไฟล์ Excel ในหน้าต่างๆ เพื่อให้ผู้ใช้สามารถดาวน์โหลดข้อมูลไปใช้งานได้

## หน้าที่รองรับการส่งออก Excel

### 1. หน้า Expense Entry (บันทึกค่าใช้จ่าย)
- **ตำแหน่งปุ่ม**: อยู่ในส่วน "ค้นหาและกรอง" ด้านขวา
- **ข้อมูลที่ส่งออก**:
  - ลำดับ
  - วันที่
  - รายการค่าใช้จ่าย
  - จำนวนเงิน (บาท)
  - โครงการ
  - หมวดหมู่
  - สถานะ (ชำระแล้ว/ค้างจ่าย)
  - หมายเหตุ
- **ยอดสรุป**:
  - ตัวกรองที่ใช้ (แสดงตัวกรองที่เลือก)
  - จำนวนรายการทั้งหมด
  - ยอดรวมทั้งหมด
  - ยอดที่ชำระแล้ว
  - ยอดที่ค้างชำระ
  - อัตราการชำระ (%)

### 2. หน้า Outstanding Expenses (ค่าใช้จ่ายค้างชำระ)
- **ตำแหน่งปุ่ม**: อยู่ในส่วน "ค้นหาและกรอง" ด้านขวา
- **ข้อมูลที่ส่งออก**:
  - ลำดับ
  - วันที่
  - รายการค่าใช้จ่าย
  - จำนวนเงิน (บาท)
  - โครงการ
  - หมวดหมู่
  - จำนวนวันที่เกินกำหนด
  - สถานะ (เกินกำหนด/ปกติ)
  - ระดับความเร่งด่วน (วิกฤต/ปานกลาง/เล็กน้อย/ปกติ)
- **ยอดสรุป**:
  - ตัวกรองที่ใช้ (แสดงตัวกรองที่เลือก)
  - จำนวนรายการทั้งหมด
  - ยอดค้างชำระรวม
  - รายการที่เกินกำหนด
  - รายการวิกฤต (30+ วัน)

### 3. หน้า Sales Entry (บันทึกยอดขาย)
- **ตำแหน่งปุ่ม**: อยู่ในส่วน "ค้นหาและกรอง" ด้านขวา
- **ข้อมูลที่ส่งออก**:
  - ลำดับ
  - วันที่
  - รายการขาย
  - จำนวน
  - ราคาต่อหน่วย (บาท)
  - ยอดขายรวม (บาท)
  - โครงการ
  - ประเภท
- **ยอดสรุป**:
  - ตัวกรองที่ใช้ (แสดงตัวกรองที่เลือก)
  - จำนวนรายการทั้งหมด
  - ยอดขายรวม
  - จำนวนรวม
  - ราคาเฉลี่ยต่อหน่วย

## การตั้งชื่อไฟล์

### กรณีมีการกรองข้อมูล
- **กรณีเดียววัน**: `รายการค่าใช้จ่าย_2024-01-15.xlsx`
- **หลายวัน**: `รายการค่าใช้จ่าย_2024-01-01_ถึง_2024-01-31.xlsx`
- **กรองแล้ว**: `รายการค่าใช้จ่าย_กรองแล้ว_2024-01-15.xlsx`

### กรณีไม่มีการกรอง (ข้อมูลทั้งหมด)
- `รายการค่าใช้จ่ายทั้งหมด_ณ_2024-01-15.xlsx`

## ข้อความแจ้งเตือน

### กรณีมีการกรอง
- **เดียววัน**: "ส่งออกข้อมูล 5 รายการ วันที่ 2024-01-15 เรียบร้อยแล้ว"
- **หลายวัน**: "ส่งออกข้อมูล 25 รายการ ตั้งแต่ 2024-01-01 ถึง 2024-01-31 เรียบร้อยแล้ว"
- **กรองแล้ว**: "ส่งออกข้อมูล 10 รายการ (กรองแล้ว) เรียบร้อยแล้ว"

### กรณีไม่มีการกรอง
- "ส่งออกข้อมูลทั้งหมด 150 รายการ ณ วันที่ 2024-01-15 เรียบร้อยแล้ว"

## การใช้งาน

### การกรองข้อมูล

#### ตัวกรองวันที่
- **วันที่เดียว**: เลือกวันที่เฉพาะเพื่อดูข้อมูลในวันนั้น
- **ช่วงวันที่**: เลือกวันที่เริ่มต้นและวันที่สิ้นสุดเพื่อดูข้อมูลในช่วงเวลาที่ต้องการ
- **การใช้งาน**: 
  - กรอกวันที่เดียว หรือ
  - กรอกวันที่เริ่มต้นและวันที่สิ้นสุด (ต้องเลือกครบทั้งสองวัน)
- **หมายเหตุ**: ระบบจะแสดงข้อความแจ้งเตือนหากเลือกแค่วันใดวันหนึ่ง และจะไม่แสดงข้อมูลจนกว่าจะเลือกครบทั้งสองวัน

#### ตัวกรองอื่นๆ
- **ชื่อรายการ**: ค้นหาตามชื่อรายการค่าใช้จ่าย/ยอดขาย
- **จำนวนเงิน**: ค้นหาตามจำนวนเงิน
- **โครงการ**: เลือกโครงการเฉพาะ
- **หมวดหมู่/ประเภท**: เลือกหมวดหมู่หรือประเภทเฉพาะ
- **สถานะ**: เลือกสถานะการชำระ (สำหรับค่าใช้จ่าย)

### การส่งออก Excel

1. **กรองข้อมูล** (ถ้าต้องการ): ใช้ตัวกรองต่างๆ เพื่อเลือกข้อมูลที่ต้องการ
2. **คลิกปุ่ม "ส่งออก Excel"**: ปุ่มสีเขียวที่มีไอคอนดาวน์โหลด
3. **รอการประมวลผล**: ระบบจะสร้างไฟล์ Excel และดาวน์โหลดอัตโนมัติ
4. **ตรวจสอบข้อความแจ้งเตือน**: ระบบจะแสดงข้อความยืนยันการส่งออก

### ตัวอย่างการใช้งานช่วงวันที่
- **เดือนมกราคม 2024**: เลือกวันที่เริ่มต้น `2024-01-01` และวันที่สิ้นสุด `2024-01-31`
- **ไตรมาสที่ 1**: เลือกวันที่เริ่มต้น `2024-01-01` และวันที่สิ้นสุด `2024-03-31`
- **ปี 2024**: เลือกวันที่เริ่มต้น `2024-01-01` และวันที่สิ้นสุด `2024-12-31`

## ข้อกำหนด

- ต้องมีข้อมูลในตารางเพื่อส่งออก
- ปุ่มจะถูกปิดใช้งานถ้าไม่มีข้อมูล
- ไฟล์จะถูกดาวน์โหลดในรูปแบบ .xlsx
- ชื่อไฟล์จะแสดงช่วงวันที่ของข้อมูลที่ส่งออก

## Dependencies ที่ใช้

- `xlsx`: สำหรับสร้างไฟล์ Excel
- `file-saver`: สำหรับดาวน์โหลดไฟล์

## การติดตั้ง

```bash
npm install xlsx file-saver @types/file-saver
```

## การจัดรูปแบบ Excel

### 1. หัวตาราง (Header)
- **สีพื้นหลัง**: สีน้ำเงิน (Expense), สีแดง (Outstanding), สีเขียว (Sales)
- **ตัวอักษร**: ตัวหนา, สีขาว
- **การจัดตำแหน่ง**: กึ่งกลางทั้งแนวตั้งและแนวนอน
- **ขอบ**: เส้นบางสีดำ

### 2. ข้อมูลในตาราง
- **ขอบ**: เส้นบางสีเทา
- **การจัดตำแหน่ง**: กึ่งกลางแนวตั้ง
- **สีพื้นหลังสลับแถว**: สีเทาอ่อน (F8F9FA)

### 3. การจัดรูปแบบเฉพาะคอลัมน์

#### Expense Entry
- **ลำดับ**: กึ่งกลาง
- **จำนวนเงิน**: ชิดขวา, รูปแบบตัวเลข #,##0.00
- **สถานะ**: กึ่งกลาง, พื้นหลังสีเขียวอ่อน

#### Outstanding Expenses
- **ลำดับ**: กึ่งกลาง
- **จำนวนเงิน**: ชิดขวา, รูปแบบตัวเลข #,##0.00
- **จำนวนวันที่เกินกำหนด**: กึ่งกลาง
- **สถานะ**: กึ่งกลาง, พื้นหลังสีแดงอ่อน
- **ระดับความเร่งด่วน**: กึ่งกลาง, ตัวหนา

#### Sales Entry
- **ลำดับ**: กึ่งกลาง
- **จำนวน**: กึ่งกลาง, รูปแบบตัวเลข #,##0
- **ราคา**: ชิดขวา, รูปแบบตัวเลข #,##0.00
- **ประเภท**: กึ่งกลาง, พื้นหลังสีเขียวอ่อน

### 4. ความกว้างคอลัมน์
- ปรับให้เหมาะสมกับเนื้อหา
- รายการ/โครงการ: กว้างขึ้นเพื่อแสดงข้อมูลได้ครบ
- หมายเหตุ: กว้างที่สุดเพื่อรองรับข้อความยาว

### 5. ความสูงแถว
- หัวตาราง: 25 points
- ข้อมูล: ความสูงอัตโนมัติ

## หมายเหตุ

- ข้อมูลที่ส่งออกจะตรงกับข้อมูลที่แสดงในหน้าจอ (หลังการกรอง)
- การส่งออกจะใช้ข้อมูลที่กรองแล้วเท่านั้น ไม่ใช่ข้อมูลทั้งหมดในระบบ
- ชื่อไฟล์จะอ้างอิงจากวันที่ของข้อมูล ไม่ใช่วันที่ส่งออก
- ไฟล์ Excel มีการจัดรูปแบบที่สวยงามและอ่านง่าย
- รองรับการพิมพ์และแชร์ได้อย่างเป็นมืออาชีพ
